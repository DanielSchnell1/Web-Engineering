<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="../css/game.css">
    <link href="https://fonts.googleapis.com/css2?family=League+Spartan&display=swap" rel="stylesheet">
</head>
<body>
    <div id="game">


    </div>
    

    <script>
        const game = document.getElementById('game');
        let htmlString = '';
        const data = [          //HIER: data ist eine JSON die vom Server kommt, nach einem Zug
            {playerIndex: 3},
            {user: 'user1', cards: ['karo 2', 'herz 3']},
            {user: 'user2', cards: ['rueckseite', 'rueckseite']},
            {user: 'user3', cards: ['rueckseite', 'rueckseite']},
            {user: 'user4', cards: ['rueckseite', 'rueckseite']}
        ];
        
        data.slice(1).forEach((user, i) => {
            htmlString += `<div class=\"player\" id=\"player ${i}\">`;
            htmlString += `<div class=\"playername\" id=\"playername ${i}\">` + user.user + "</div>";
            htmlString += `<div class=\"cards\" id=\"cards ${i}\">`
            user.cards.forEach((card, j) => {
                htmlString += `<img src=\"../img/cards/${card}.svg\" alt=\"${card}\" class=\"card\" draggable=\"true\" id=\"${i} ${j}\">`
            });
            htmlString += "</div></div>"
        });
        game.innerHTML = htmlString;

        const images = document.querySelectorAll('img[draggable="true"]');
        let move = [];

        images.forEach(img => {
            
            img.addEventListener('dragstart', (e) => {
                move[0] = (e.target.id); 
            });
            img.addEventListener("dragover", (e) => {
                e.preventDefault();
                img.classList.add("drag-over");
            });
            img.addEventListener("dragleave", () => {
                img.classList.remove("drag-over");
            });
            img.addEventListener("drop", (e) => {
                e.preventDefault();
                img.classList.remove("drag-over");
                move[1] = (e.target.id); 
                console.log("move: "+ move);    //HIER: schicke Server die JSON move + token -> Serverseitige Validierung
                move = [];
            });
        });
        
        
    </script>
</body>

</html>
